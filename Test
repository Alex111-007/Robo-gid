#include <GyverStepper.h>

GStepper< STEPPER2WIRE> stepperL(1024, 2, 3, 4);
GStepper< STEPPER2WIRE> stepperR(1024, 5, 6, 7);

int command;
int distanse = 1024;


void S() {
  stepperL.setTarget(0, RELATIVE);
  stepperR.setTarget(0, RELATIVE);
}

void ZiD() {
  distanse = distanse + 1024;
}
void ZoD() {
  distanse = distanse - 1024;
}

void MF() {
  stepperL.setTarget(-distanse, RELATIVE);
  stepperR.setTarget(distanse, RELATIVE);
}
void MB() {
  stepperL.setTarget(distanse, RELATIVE);
  stepperR.setTarget(-distanse, RELATIVE);
}
void RL() {
  stepperL.setTarget(distanse, RELATIVE);
  stepperR.setTarget(distanse, RELATIVE);
}
void RR() {
  stepperL.setTarget(-distanse, RELATIVE);
  stepperR.setTarget(-distanse, RELATIVE);
}

void setup() {
  Serial.begin(115200);
  stepperL.setRunMode(FOLLOW_POS);
  stepperL.setMaxSpeed(1000);
  stepperL.setAcceleration(500);
  stepperL.enable();

  stepperR.setRunMode(FOLLOW_POS);
  stepperR.setMaxSpeed(1000);
  stepperR.setAcceleration(500);
  stepperR.enable();
}
void loop() {
  if (Serial.available()) {
    command = Serial.read() - 48;
    Serial.println(command);
  }
  if (command == 0) {
    S();
  }

  else if (command == -5) {
    ZiD();
  }
  else if (command == -3) {
    ZoD();
  }
  
  if (!stepperL.tick() || !stepperR.tick()) {
    if (command == 8) {
      MF();
    }
    else if (command == 2) {
      MB();
    }
    else if (command == 4) {
      RL();
    }
    else if (command == 6) {
      RR();
    }
  }
}
